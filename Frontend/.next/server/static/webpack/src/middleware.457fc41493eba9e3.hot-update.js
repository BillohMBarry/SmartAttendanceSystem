"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/**\r\n * @fileoverview Next.js middleware for route protection.\r\n * Handles authentication and role-based access control.\r\n */ \n/**\r\n * Public routes that don't require authentication\r\n */ const publicRoutes = [\n    \"/login\",\n    \"/signup\"\n];\n/**\r\n * Admin-only routes that require admin role\r\n */ const adminRoutes = [\n    \"/admin\"\n];\n/**\r\n * Cookie name for auth token\r\n */ const TOKEN_COOKIE = \"attendance_auth_token\";\n/**\r\n * Decode JWT token to extract payload (without verification)\r\n * Note: Verification is done server-side, this is just for routing decisions\r\n */ function decodeToken(token) {\n    try {\n        const parts = token.split(\".\");\n        if (parts.length !== 3) return null;\n        const payload = parts[1];\n        const decoded = atob(payload.replace(/-/g, \"+\").replace(/_/g, \"/\"));\n        return JSON.parse(decoded);\n    } catch  {\n        return null;\n    }\n}\n/**\r\n * Middleware function to protect routes\r\n */ function middleware(request) {\n    const { pathname } = request.nextUrl;\n    // Get auth token from cookies\n    const token = request.cookies.get(TOKEN_COOKIE)?.value;\n    // Check if current route is public\n    const isPublicRoute = publicRoutes.some((route)=>pathname.startsWith(route));\n    // Check if current route is admin-only\n    const isAdminRoute = adminRoutes.some((route)=>pathname.startsWith(route));\n    // If no token and trying to access protected route, redirect to login\n    if (!token && !isPublicRoute) {\n        const loginUrl = new URL(\"/login\", request.url);\n        loginUrl.searchParams.set(\"redirect\", pathname);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(loginUrl);\n    }\n    // If has token but on login page, redirect to dashboard\n    if (token && isPublicRoute) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n    }\n    // Check for admin routes\n    if (token && isAdminRoute) {\n        const payload = decodeToken(token);\n        // If not admin, redirect to dashboard\n        if (!payload || payload.role !== \"admin\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n        // Check if token is expired\n        const now = Math.floor(Date.now() / 1000);\n        if (payload.exp < now) {\n            // Token expired, redirect to login\n            const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/login\", request.url));\n            response.cookies.delete(TOKEN_COOKIE);\n            return response;\n        }\n    }\n    // Continue with the request\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\n/**\r\n * Configure which routes should be processed by middleware\r\n */ const config = {\n    matcher: [\n        /*\r\n         * Match all request paths except:\r\n         * - api (API routes)\r\n         * - _next/static (static files)\r\n         * - _next/image (image optimization files)\r\n         * - favicon.ico (favicon file)\r\n         * - public files (images, etc.)\r\n         */ \"/((?!api|_next/static|_next/image|favicon.ico|.*\\\\..*|_next).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7OztDQUdDLEdBRTBDO0FBRzNDOztDQUVDLEdBQ0QsTUFBTUMsZUFBZTtJQUFDO0lBQVU7Q0FBVTtBQUUxQzs7Q0FFQyxHQUNELE1BQU1DLGNBQWM7SUFBQztDQUFTO0FBRTlCOztDQUVDLEdBQ0QsTUFBTUMsZUFBZTtBQUVyQjs7O0NBR0MsR0FDRCxTQUFTQyxZQUFZQyxLQUFhO0lBQzlCLElBQUk7UUFDQSxNQUFNQyxRQUFRRCxNQUFNRSxLQUFLLENBQUM7UUFDMUIsSUFBSUQsTUFBTUUsTUFBTSxLQUFLLEdBQUcsT0FBTztRQUUvQixNQUFNQyxVQUFVSCxLQUFLLENBQUMsRUFBRTtRQUN4QixNQUFNSSxVQUFVQyxLQUFLRixRQUFRRyxPQUFPLENBQUMsTUFBTSxLQUFLQSxPQUFPLENBQUMsTUFBTTtRQUM5RCxPQUFPQyxLQUFLQyxLQUFLLENBQUNKO0lBQ3RCLEVBQUUsT0FBTTtRQUNKLE9BQU87SUFDWDtBQUNKO0FBRUE7O0NBRUMsR0FDTSxTQUFTSyxXQUFXQyxPQUFvQjtJQUMzQyxNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxRQUFRRSxPQUFPO0lBRXBDLDhCQUE4QjtJQUM5QixNQUFNYixRQUFRVyxRQUFRRyxPQUFPLENBQUNDLEdBQUcsQ0FBQ2pCLGVBQWVrQjtJQUVqRCxtQ0FBbUM7SUFDbkMsTUFBTUMsZ0JBQWdCckIsYUFBYXNCLElBQUksQ0FBQyxDQUFDQyxRQUFVUCxTQUFTUSxVQUFVLENBQUNEO0lBRXZFLHVDQUF1QztJQUN2QyxNQUFNRSxlQUFleEIsWUFBWXFCLElBQUksQ0FBQyxDQUFDQyxRQUFVUCxTQUFTUSxVQUFVLENBQUNEO0lBRXJFLHNFQUFzRTtJQUN0RSxJQUFJLENBQUNuQixTQUFTLENBQUNpQixlQUFlO1FBQzFCLE1BQU1LLFdBQVcsSUFBSUMsSUFBSSxVQUFVWixRQUFRYSxHQUFHO1FBQzlDRixTQUFTRyxZQUFZLENBQUNDLEdBQUcsQ0FBQyxZQUFZZDtRQUN0QyxPQUFPakIscURBQVlBLENBQUNnQyxRQUFRLENBQUNMO0lBQ2pDO0lBRUEsd0RBQXdEO0lBQ3hELElBQUl0QixTQUFTaUIsZUFBZTtRQUN4QixPQUFPdEIscURBQVlBLENBQUNnQyxRQUFRLENBQUMsSUFBSUosSUFBSSxLQUFLWixRQUFRYSxHQUFHO0lBQ3pEO0lBRUEseUJBQXlCO0lBQ3pCLElBQUl4QixTQUFTcUIsY0FBYztRQUN2QixNQUFNakIsVUFBVUwsWUFBWUM7UUFFNUIsc0NBQXNDO1FBQ3RDLElBQUksQ0FBQ0ksV0FBV0EsUUFBUXdCLElBQUksS0FBSyxTQUFTO1lBQ3RDLE9BQU9qQyxxREFBWUEsQ0FBQ2dDLFFBQVEsQ0FBQyxJQUFJSixJQUFJLEtBQUtaLFFBQVFhLEdBQUc7UUFDekQ7UUFFQSw0QkFBNEI7UUFDNUIsTUFBTUssTUFBTUMsS0FBS0MsS0FBSyxDQUFDQyxLQUFLSCxHQUFHLEtBQUs7UUFDcEMsSUFBSXpCLFFBQVE2QixHQUFHLEdBQUdKLEtBQUs7WUFDbkIsbUNBQW1DO1lBQ25DLE1BQU1LLFdBQVd2QyxxREFBWUEsQ0FBQ2dDLFFBQVEsQ0FBQyxJQUFJSixJQUFJLFVBQVVaLFFBQVFhLEdBQUc7WUFDcEVVLFNBQVNwQixPQUFPLENBQUNxQixNQUFNLENBQUNyQztZQUN4QixPQUFPb0M7UUFDWDtJQUNKO0lBRUEsNEJBQTRCO0lBQzVCLE9BQU92QyxxREFBWUEsQ0FBQ3lDLElBQUk7QUFDNUI7QUFFQTs7Q0FFQyxHQUNNLE1BQU1DLFNBQVM7SUFDbEJDLFNBQVM7UUFDTDs7Ozs7OztTQU9DLEdBQ0Q7S0FDSDtBQUNMLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL21pZGRsZXdhcmUudHM/ZDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGZpbGVvdmVydmlldyBOZXh0LmpzIG1pZGRsZXdhcmUgZm9yIHJvdXRlIHByb3RlY3Rpb24uXHJcbiAqIEhhbmRsZXMgYXV0aGVudGljYXRpb24gYW5kIHJvbGUtYmFzZWQgYWNjZXNzIGNvbnRyb2wuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgdHlwZSB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5cclxuLyoqXHJcbiAqIFB1YmxpYyByb3V0ZXMgdGhhdCBkb24ndCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uXHJcbiAqL1xyXG5jb25zdCBwdWJsaWNSb3V0ZXMgPSBbJy9sb2dpbicsICcvc2lnbnVwJ107XHJcblxyXG4vKipcclxuICogQWRtaW4tb25seSByb3V0ZXMgdGhhdCByZXF1aXJlIGFkbWluIHJvbGVcclxuICovXHJcbmNvbnN0IGFkbWluUm91dGVzID0gWycvYWRtaW4nXTtcclxuXHJcbi8qKlxyXG4gKiBDb29raWUgbmFtZSBmb3IgYXV0aCB0b2tlblxyXG4gKi9cclxuY29uc3QgVE9LRU5fQ09PS0lFID0gJ2F0dGVuZGFuY2VfYXV0aF90b2tlbic7XHJcblxyXG4vKipcclxuICogRGVjb2RlIEpXVCB0b2tlbiB0byBleHRyYWN0IHBheWxvYWQgKHdpdGhvdXQgdmVyaWZpY2F0aW9uKVxyXG4gKiBOb3RlOiBWZXJpZmljYXRpb24gaXMgZG9uZSBzZXJ2ZXItc2lkZSwgdGhpcyBpcyBqdXN0IGZvciByb3V0aW5nIGRlY2lzaW9uc1xyXG4gKi9cclxuZnVuY3Rpb24gZGVjb2RlVG9rZW4odG9rZW46IHN0cmluZyk6IHsgaWQ6IHN0cmluZzsgcm9sZTogc3RyaW5nOyBleHA6IG51bWJlciB9IHwgbnVsbCB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gdG9rZW4uc3BsaXQoJy4nKTtcclxuICAgICAgICBpZiAocGFydHMubGVuZ3RoICE9PSAzKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IHBhcnRzWzFdO1xyXG4gICAgICAgIGNvbnN0IGRlY29kZWQgPSBhdG9iKHBheWxvYWQucmVwbGFjZSgvLS9nLCAnKycpLnJlcGxhY2UoL18vZywgJy8nKSk7XHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjb2RlZCk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE1pZGRsZXdhcmUgZnVuY3Rpb24gdG8gcHJvdGVjdCByb3V0ZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgICBjb25zdCB7IHBhdGhuYW1lIH0gPSByZXF1ZXN0Lm5leHRVcmw7XHJcblxyXG4gICAgLy8gR2V0IGF1dGggdG9rZW4gZnJvbSBjb29raWVzXHJcbiAgICBjb25zdCB0b2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoVE9LRU5fQ09PS0lFKT8udmFsdWU7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgY3VycmVudCByb3V0ZSBpcyBwdWJsaWNcclxuICAgIGNvbnN0IGlzUHVibGljUm91dGUgPSBwdWJsaWNSb3V0ZXMuc29tZSgocm91dGUpID0+IHBhdGhuYW1lLnN0YXJ0c1dpdGgocm91dGUpKTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiBjdXJyZW50IHJvdXRlIGlzIGFkbWluLW9ubHlcclxuICAgIGNvbnN0IGlzQWRtaW5Sb3V0ZSA9IGFkbWluUm91dGVzLnNvbWUoKHJvdXRlKSA9PiBwYXRobmFtZS5zdGFydHNXaXRoKHJvdXRlKSk7XHJcblxyXG4gICAgLy8gSWYgbm8gdG9rZW4gYW5kIHRyeWluZyB0byBhY2Nlc3MgcHJvdGVjdGVkIHJvdXRlLCByZWRpcmVjdCB0byBsb2dpblxyXG4gICAgaWYgKCF0b2tlbiAmJiAhaXNQdWJsaWNSb3V0ZSkge1xyXG4gICAgICAgIGNvbnN0IGxvZ2luVXJsID0gbmV3IFVSTCgnL2xvZ2luJywgcmVxdWVzdC51cmwpO1xyXG4gICAgICAgIGxvZ2luVXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3JlZGlyZWN0JywgcGF0aG5hbWUpO1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobG9naW5VcmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIGhhcyB0b2tlbiBidXQgb24gbG9naW4gcGFnZSwgcmVkaXJlY3QgdG8gZGFzaGJvYXJkXHJcbiAgICBpZiAodG9rZW4gJiYgaXNQdWJsaWNSb3V0ZSkge1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnLycsIHJlcXVlc3QudXJsKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIGFkbWluIHJvdXRlc1xyXG4gICAgaWYgKHRva2VuICYmIGlzQWRtaW5Sb3V0ZSkge1xyXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBkZWNvZGVUb2tlbih0b2tlbik7XHJcblxyXG4gICAgICAgIC8vIElmIG5vdCBhZG1pbiwgcmVkaXJlY3QgdG8gZGFzaGJvYXJkXHJcbiAgICAgICAgaWYgKCFwYXlsb2FkIHx8IHBheWxvYWQucm9sZSAhPT0gJ2FkbWluJykge1xyXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy8nLCByZXF1ZXN0LnVybCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdG9rZW4gaXMgZXhwaXJlZFxyXG4gICAgICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApO1xyXG4gICAgICAgIGlmIChwYXlsb2FkLmV4cCA8IG5vdykge1xyXG4gICAgICAgICAgICAvLyBUb2tlbiBleHBpcmVkLCByZWRpcmVjdCB0byBsb2dpblxyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvbG9naW4nLCByZXF1ZXN0LnVybCkpO1xyXG4gICAgICAgICAgICByZXNwb25zZS5jb29raWVzLmRlbGV0ZShUT0tFTl9DT09LSUUpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbnRpbnVlIHdpdGggdGhlIHJlcXVlc3RcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ29uZmlndXJlIHdoaWNoIHJvdXRlcyBzaG91bGQgYmUgcHJvY2Vzc2VkIGJ5IG1pZGRsZXdhcmVcclxuICovXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgICBtYXRjaGVyOiBbXHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiBNYXRjaCBhbGwgcmVxdWVzdCBwYXRocyBleGNlcHQ6XHJcbiAgICAgICAgICogLSBhcGkgKEFQSSByb3V0ZXMpXHJcbiAgICAgICAgICogLSBfbmV4dC9zdGF0aWMgKHN0YXRpYyBmaWxlcylcclxuICAgICAgICAgKiAtIF9uZXh0L2ltYWdlIChpbWFnZSBvcHRpbWl6YXRpb24gZmlsZXMpXHJcbiAgICAgICAgICogLSBmYXZpY29uLmljbyAoZmF2aWNvbiBmaWxlKVxyXG4gICAgICAgICAqIC0gcHVibGljIGZpbGVzIChpbWFnZXMsIGV0Yy4pXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgJy8oKD8hYXBpfF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljb3wuKlxcXFwuLip8X25leHQpLiopJyxcclxuICAgIF0sXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwdWJsaWNSb3V0ZXMiLCJhZG1pblJvdXRlcyIsIlRPS0VOX0NPT0tJRSIsImRlY29kZVRva2VuIiwidG9rZW4iLCJwYXJ0cyIsInNwbGl0IiwibGVuZ3RoIiwicGF5bG9hZCIsImRlY29kZWQiLCJhdG9iIiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwicGF0aG5hbWUiLCJuZXh0VXJsIiwiY29va2llcyIsImdldCIsInZhbHVlIiwiaXNQdWJsaWNSb3V0ZSIsInNvbWUiLCJyb3V0ZSIsInN0YXJ0c1dpdGgiLCJpc0FkbWluUm91dGUiLCJsb2dpblVybCIsIlVSTCIsInVybCIsInNlYXJjaFBhcmFtcyIsInNldCIsInJlZGlyZWN0Iiwicm9sZSIsIm5vdyIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJleHAiLCJyZXNwb25zZSIsImRlbGV0ZSIsIm5leHQiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});